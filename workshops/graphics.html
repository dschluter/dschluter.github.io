<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="" />


<title>Displaying data using graphs and tables</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="workshops.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">UBC Biology 501 R workshops</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Biol 501 home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Workshops
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="index.html">Main workshops page</a>
    </li>
    <li>
      <a href="workshops-intro.html">1. Introduction to R</a>
    </li>
    <li>
      <a href="graphics.html">2. Graphs and tables</a>
    </li>
    <li>
      <a href="exp-design.html">3. Plan experiments</a>
    </li>
    <li>
      <a href="linearmodels.html">4. Linear models</a>
    </li>
    <li>
      <a href="lme.html">5. Mixed-effects models</a>
    </li>
    <li>
      <a href="likelihood.html">6. Likelihood</a>
    </li>
    <li>
      <a href="glm.html">7. Generalized linear models</a>
    </li>
    <li>
      <a href="modelselection.html">8. Model selection</a>
    </li>
    <li>
      <a href="bayes.html">9. Bayesian inference</a>
    </li>
    <li>
      <a href="resampling.html">10. Bootstrap and permutation</a>
    </li>
    <li>
      <a href="meta.html">11. Meta-analysis</a>
    </li>
    <li>
      <a href="multivariate.html">12. Multivariate methods</a>
    </li>
    <li>
      <a href="phylogenetic.html">13. Phylogenetic comparative methods</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R tips pages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../rtips/index.html">R tips home page</a>
    </li>
    <li>
      <a href="../rtips/Calculate.html">Calculate with R</a>
    </li>
    <li>
      <a href="../rtips/Data.html">Data sets</a>
    </li>
    <li>
      <a href="../rtips/Display.html">Graphs &amp; Tables</a>
    </li>
    <li>
      <a href="../rtips/Plan.html">Planning tools</a>
    </li>
    <li>
      <a href="../rtips/Loop.html">Loop, repeat</a>
    </li>
    <li>
      <a href="../rtips/Model.html">Fit model</a>
    </li>
    <li>
      <a href="../rtips/Prob.html">Probability &amp; Likelihood</a>
    </li>
    <li>
      <a href="../rtips/Resample.html">Resample, Bootstrap</a>
    </li>
    <li>
      <a href="../rtips/Meta.html">Meta-analysis</a>
    </li>
    <li>
      <a href="../rtips/Multivariate.html">Multivariate methods</a>
    </li>
    <li>
      <a href="../rtips/Phylogenetic.html">Phylogenetic comparison</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Displaying data using graphs and tables</h1>

</div>


<!--
knitr:: seems to be the best way to control figure dimensions with ggplots. 
It may be necessary to force a different width and height for individual plots 
in base R, e.g., see mosaicplot() and plot() used for scatter plot of guppy data
-->
<p>The purpose of this exercise is to tour the table and graphics capabilities of R, and to explore the best methods for displaying patterns in data. If you need help with some of the commands, check the “Graphs &amp; Tables” tab at the <a href="https://www.zoology.ubc.ca/~schluter/R/">R tips</a> page.</p>
<hr />
<div id="data-set-1-mammal-body-mass" class="section level2">
<h2>Data set 1: Mammal body mass</h2>
<p>These data were published as a data paper in Ecology and deposited in the <i>Ecological Archives</i> (F. A. Smith, S. K. Lyons, S. K. M. Ernest, K. E. Jones, D. M. Kaufman, T. Dayan, P. A. Marquet, J. H. Brown, and J. P. Haskell. 2003. Body mass of late Quaternary mammals. <i>Ecology</i> 84: 3403.) See the <a href="http://www.esapubs.org/archive/ecol/E084/094/">metadata</a> for a description.</p>
<p>Most of the variables are categorical, with multiple named categories. “Continent” includes mammals on islands (“Insular” category) whereas “Oceanic” refers to marine mammals. Body mass (in grams) is the sole numeric variable. The “status” variable indicates whether species is currently present in the wild (extant), extinct as of late Pleistocene (extinct), extinct within the last 300 years (historical), or an introduced species (introduction).</p>
<p><br></p>
<div id="read-and-examine-the-data" class="section level3">
<h3>Read and examine the data</h3>
<p>The original data were saved in mammals.csv file on our server <a href="https://www.zoology.ubc.ca/~bio501/R/data/mammals.csv">here</a>. Download the file to your computer and open in a spreadsheet program (e.g., Excel, Calc) to have a look at it.</p>
<p>Start R and read the contents of the file to a data frame. You will need to modify the default argument that identifies missing data to <code>na.strings="“</code> (or <code>na=”“</code> if you are using <code>read_csv</code> from the <code>readr</code> package) because in this data file”NA" is used to symbolize North America in the continent column rather than missing data (don’t do this in your own data).</p>
<p>Use the <code>head</code> function to view the first few lines of the data frame on the screen. You’ll see that every row represents the data for a different mammal species.</p>
<p><br></p>
</div>
<div id="frequency-tables" class="section level3">
<h3>Frequency tables</h3>
<ol>
<li>
Which continent has the greatest number of mammal species? Which has the least? Make a table of the frequency of cases on each continent (remember that the category “NA” in continent stands for North America, not missing data).
</li>
<li>
You’ll notice in the frequency table for the variable “continent” that there’s a typo in the data. One case is shown as having the continent “Af” rather than “AF”. Fix this using the command line in R and recalculate the frequency table.
</li>
<li>
How many extinct mammals are recorded in the data file? Use a frequency table to find out.
</li>
<li>
Create a two-way frequency table (contingency table) showing the status of mammal species on each continent.
</li>
<li>
Judging by eye, which continent has the greatest number of extinctions relative to the number of extant species?
</li>
</ol>
</div>
<div id="answers" class="section level3">
<h3>Answers</h3>
<p>All lines below beginning with double hashes are R output</p>
<pre class="r"><code># Load the packages you might need
# (I&#39;m including warn.conflicts=FALSE just to shorten the output here)
library(readr, warn.conflicts=FALSE)
library(dplyr, warn.conflicts = FALSE)

# Read and inspect the data
mammals &lt;- read.csv(url(&quot;https://www.zoology.ubc.ca/~bio501/R/data/mammals.csv&quot;), 
                    na.strings=&quot;&quot;, stringsAsFactors = FALSE)
head(mammals)</code></pre>
<pre><code>##   continent status        order  family      genus       species mass.grams
## 1        AF extant Artiodactyla Bovidae      Addax nasomaculatus    70000.3
## 2        AF extant Artiodactyla Bovidae  Aepyceros      melampus    52500.1
## 3        AF extant Artiodactyla Bovidae Alcelaphus    buselaphus   171001.5
## 4        AF extant Artiodactyla Bovidae Ammodorcas       clarkei    28049.8
## 5        AF extant Artiodactyla Bovidae Ammotragus        lervia    48000.0
## 6        AF extant Artiodactyla Bovidae Antidorcas   marsupialis    39049.9</code></pre>
<pre class="r"><code># You could also use read_csv from the readr package (not run here)
# mammals &lt;- read_csv(url(&quot;https://www.zoology.ubc.ca/~bio501/R/data/mammals.csv&quot;), 
#                    na = c(&quot;&quot;))

# Number of mammal species on each continent
table(mammals$continent)</code></pre>
<pre><code>## 
##      Af      AF     AUS      EA Insular      NA Oceanic      SA 
##       1    1033     346    1033    1484     779      78     977</code></pre>
<pre class="r"><code># Fix &quot;Af&quot;
which(mammals$continent==&quot;Af&quot;)</code></pre>
<pre><code>## [1] 322</code></pre>
<pre class="r"><code>mammals$continent[322]&lt;-&quot;AF&quot;
table(mammals$continent)</code></pre>
<pre><code>## 
##      AF     AUS      EA Insular      NA Oceanic      SA 
##    1034     346    1033    1484     779      78     977</code></pre>
<pre class="r"><code># How many extinct mammals?
# The table shows that 242 species of mammal are listed as extinct
z &lt;- table(mammals$status)
z</code></pre>
<pre><code>## 
##       extant      extinct   historical introduction 
##         5388          242           84           17</code></pre>
<pre class="r"><code># Extinction status by continent (contingency table)
# The table shows that Australia (AUS) has the greatest number of extinct species
#   relative to the total number.
table(mammals$continent, mammals$status)</code></pre>
<pre><code>##          
##           extant extinct historical introduction
##   AF        1017      13          4            0
##   AUS        261      45         23           17
##   EA        1027       0          6            0
##   Insular   1405      29         50            0
##   NA         700      78          1            0
##   Oceanic     78       0          0            0
##   SA         900      77          0            0</code></pre>
<p><br></p>
</div>
<div id="graphing-frequency-distributions" class="section level3">
<h3>Graphing frequency distributions</h3>
<ol>
<li>
Plot the number of mammal species on each continent using a simple bar graph. Include a label for the y axis.
</li>
<li>
The plot categories are listed in alphabetical order by default, which is arbitrary and makes the visual display less efficient than other possibilities. Redo the bar graph with the continents appearing in order of decreasing numbers of species.
</li>
<li>
Generate a histogram of the body masses of mammal species. How informative is that?!
</li>
<li>
Create a new variable in the mammal data frame: the log (base 10) of body mass. (See “Transform and add a variable” on the R tips “Data” page if you need help with this.)
</li>
<li>
Generate a histogram of log body mass. Is this more informative? Morphological data commonly require a log-transformation to analyze.
</li>
<li>
Redo the previous histogram but use a bin width of 2 units. How much detail is lost?
</li>
<li>
Redo the histogram but try a bin width of of 1; then try 0.5; and then 0.1. Which bin width is superior?
</li>
<li>
Redo the histogram, but display probability density instead of frequency.
</li>
<li>
How does the frequency distribution of log body mass depart from a normal distribution? Answer by visual examination of the histogram you just created. Now answer by examining a normal quantile plot instead. Which display is more informative?
</li>
<li>
Optional: redraw the histogram of log body mass and superimpose a normal density curve to assess help detect deviations from normality.
</li>
</ol>
</div>
<div id="answers-1" class="section level3">
<h3>Answers</h3>
<p>All lines below beginning with double hashes are R output</p>
<pre class="r"><code># Load the packages you might need
library(ggplot2, warn.conflicts=FALSE)

# Bar plot of mammal species by continent
barplot(table(mammals$continent), col=&quot;firebrick&quot;, cex.names=0.8, 
        ylim=c(0,1600), las = 1)</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-2-1.png" width="528" /></p>
<pre class="r"><code># Barplot sorted by frequency
barplot(sort(table(mammals$continent), decreasing=TRUE), col=&quot;firebrick&quot;,   
        cex.names=0.8, las = 1, ylim=c(0,1600), ylab=&quot;Frequency&quot;)</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-2-2.png" width="528" /></p>
<pre class="r"><code># ggplot methods
ggplot(mammals, aes(x=continent)) + 
    geom_bar(stat=&quot;count&quot;, fill = &quot;firebrick&quot;) +
    labs(x = &quot;Continent&quot;, y = &quot;Frequency&quot;) +
  theme_classic()</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-3-1.png" width="528" /></p>
<pre class="r"><code># To order by category in ggplot, first make a new factor variable
mammals$continent_ordered &lt;- factor(mammals$continent, 
                levels = names(sort(table(mammals$continent), decreasing = TRUE)) )

ggplot(mammals, aes(x=continent_ordered)) + 
    geom_bar(stat=&quot;count&quot;, fill = &quot;firebrick&quot;) +
    labs(x = &quot;Continent&quot;, y = &quot;Frequency&quot;) +
  theme_classic()</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-3-2.png" width="528" /></p>
<pre class="r"><code># Histogram of body masses
hist(mammals$mass.grams, col=&quot;firebrick&quot;, right = FALSE, las = 1, 
     xlab = &quot;Body mass (g)&quot;, main = &quot;&quot;)</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-4-1.png" width="528" /></p>
<pre class="r"><code># Add a new variable, log10 of body mass
mammals$logmass &lt;- log10(mammals$mass.grams)

hist(mammals$logmass, col=&quot;firebrick&quot;, right = FALSE, las = 1, 
     xlab = &quot;Log10 body mass&quot;, main = &quot;&quot;, breaks = seq(0, 8.5, by = 0.5))</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-4-2.png" width="528" /></p>
<p>Same but using <code>ggplot</code>. You’ll see a <code>Warning: Removed ?? rows containing non-finite values</code>. These are rows with missing data on mass. Use the argument <code>na.rm = TRUE</code> in geom_histogram to get rid of the warning.</p>
<pre class="r"><code>ggplot(mammals, aes(x = logmass)) + 
    geom_histogram(fill = &quot;firebrick&quot;, col = &quot;black&quot;, binwidth = 0.5, boundary = 0) + 
    labs(x = &quot;log10 body mass&quot;, y = &quot;Frequency&quot;) + 
    theme_classic()</code></pre>
<pre><code>## Warning: Removed 1372 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-5-1.png" width="528" /></p>
<pre class="r"><code># Results with different bin widths not shown</code></pre>
<pre class="r"><code># Plot density instead
hist(mammals$logmass, col=&quot;firebrick&quot;, right = FALSE, las = 1, prob = TRUE,
     xlab = &quot;Log10 body mass&quot;, main = &quot;&quot;, breaks = seq(0, 8.5, by = 0.5))</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-6-1.png" width="528" /></p>
<pre class="r"><code># or
ggplot(mammals, aes(x = logmass)) + 
    geom_histogram(fill = &quot;firebrick&quot;, col = &quot;black&quot;, binwidth = 0.5, 
                 boundary = 0, aes(y = ..density..)) + 
    labs(x = &quot;log10 body mass&quot;, y = &quot;Density&quot;) + 
  theme_classic()</code></pre>
<pre><code>## Warning: Removed 1372 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-6-2.png" width="528" /></p>
<pre class="r"><code># Normal quantile plot
qqnorm(mammals$logmass)
qqline(mammals$logmass) # adds the straight line for comparison through 1st and 3rd quartiles</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-7-1.png" width="528" /></p>
<pre class="r"><code># Histogram with best-fit normal curve superimposed.
# The curve function is fussy about the name of the variable: must be &quot;x&quot;
x &lt;- mammals$logmass
hist(x, col=&quot;firebrick&quot;, right = FALSE, las = 1, prob = TRUE,
     xlab = &quot;Log10 body mass&quot;, main = &quot;&quot;, breaks = seq(0, 8.5, by = 0.5))
m &lt;- mean(x, na.rm = TRUE)
s &lt;- sd(x, na.rm = TRUE)
curve(dnorm(x, mean = m, sd = s), col=&quot;red&quot;, lwd = 2, add = TRUE)</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-7-2.png" width="528" /></p>
<p><br></p>
</div>
<div id="comparing-frequency-distributions" class="section level3">
<h3>Comparing frequency distributions</h3>
<ol>
<li>
Use a box plot to compare the distribution of body sizes (log scale most revealing) of mammals having different extinction status. Are extinct mammals similar to, larger than, or smaller than, extant mammals?
</li>
<li>
Examine the previous box plot. How do the shapes of the body size distributions compare between extinct and extant mammals?
</li>
<li>
Redo the previous box plot but make box width proportional to the square root of sample size. Add a title to the plot.
</li>
<li>
Optional: Draw a violin plot to compare the frequency distribution of log body sizes of mammals having different extinction status. Which do you find is more revealing about the shapes of the body size distributions: box plot or violin plot?
</li>
<li>
Use multiple histograms to compare the frequency distribution of log body sizes of mammals having different extinction status. Stack the panels one above the other. In this plot, how easy is it to visualize differences among treatments in the distributions compared to your previous plots?
</li>
<li>
Make a table of the median log body mass of each extinction-status group of mammals. Are the values consistent with the plotted distributions?
</li>
</ol>
</div>
<div id="answers-2" class="section level3">
<h3>Answers</h3>
<p>All lines below beginning with double hashes are R output</p>
<pre class="r"><code># Box plot to compare the distribution of body sizes
# Extinct mammals tend to have large mass compared to extant mammals.
# The frequency distributions for these two groups also have opposite skew.

boxplot(logmass ~ status, data = mammals, ylab = &quot;log10 body mass&quot;, 
        col = &quot;goldenrod1&quot;, las = 1)</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-8-1.png" width="528" /></p>
<pre class="r"><code># or ggplot method
ggplot(mammals, aes(x = status, y = logmass)) + 
    geom_boxplot(fill = &quot;goldenrod1&quot;, notch = FALSE) + 
    labs(x = &quot;Status&quot;, y = &quot;Log10 body mass&quot;) + 
    theme_classic()</code></pre>
<pre><code>## Warning: Removed 1372 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-8-2.png" width="528" /></p>
<pre class="r"><code># Violin plot
ggplot(mammals, aes(x = status, y = logmass)) + 
    geom_violin(fill = &quot;goldenrod1&quot;) + 
    labs(x = &quot;Status&quot;, y = &quot;Log10 body mass&quot;) + 
    stat_summary(fun.y = mean,  geom = &quot;point&quot;, color = &quot;black&quot;) +
  theme_classic()</code></pre>
<pre><code>## Warning: `fun.y` is deprecated. Use `fun` instead.</code></pre>
<pre><code>## Warning: Removed 1372 rows containing non-finite values (stat_ydensity).</code></pre>
<pre><code>## Warning: Removed 1372 rows containing non-finite values (stat_summary).</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-8-3.png" width="528" /></p>
<pre class="r"><code># Multiple histograms
ggplot(mammals, aes(x = logmass)) + 
    geom_histogram(fill = &quot;goldenrod1&quot;, col = &quot;black&quot;, 
             binwidth = 0.2, boundary = 0) +
    labs(x = &quot;log10 body mass&quot;, y = &quot;Frequency&quot;) + 
    facet_wrap(~status, ncol = 1, scales = &quot;free_y&quot;, strip.position = &quot;right&quot;) +
  theme_classic()</code></pre>
<pre><code>## Warning: Removed 1372 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-8-4.png" width="528" /></p>
<hr />
</div>
</div>
<div id="data-set-2-fly-sex-and-longevity" class="section level2">
<h2>Data set 2: Fly sex and longevity</h2>
<p>The data are from L. Partridge and M. Farquhar (1981), Sexual activity and the lifespan of male fruitflies, <it>Nature</it> 294: 580-581. The experiment placed male fruit flies with varying numbers of previously-mated or virgin females to investigate how mating activity affects male lifespan. The data are in the file fruitflies.csv file on our server <a href="https://www.zoology.ubc.ca/~bio501/R/data/fruitflies.csv">here</a>.</p>
<p><br></p>
<div id="download-and-inspect" class="section level3">
<h3>Download and inspect</h3>
<p>Download the file to your computer and open in a spreadsheet program to have a look at it. View the first few lines of the data frame on the screen, and familiarize yourself with the variable names.</p>
<p>Our goal here is to find a plot type that clearly and efficiently visualizes the patterns in the data, especially the differences among groups.</p>
<p><br></p>
</div>
<div id="analyze" class="section level3">
<h3>Analyze</h3>
<ol>
<li>
Read the data file into a new data frame.
</li>
<li>
Use a strip chart to examine the distribution of longevities in the treatment groups. Try the jitter method to reduce overlap between points. If needed, adjust the size or rotation of the treatment labels so that they all fit on the graph. What pattern of differences between treatments in longevity is revealed?
</li>
<li>
Compare the strip chart to a box plot of the same data. Is the pattern in the data as clear in both types of plot?
</li>
<li>
The variable <code>thorax</code> stands for thorax length, which was used as a measure of body size. The measurement was included in case body size also affected longevity. Produce a scatter plot of thorax length and longevity. Make <code>longevity</code> the response variable (i.e., plot it on the vertical axis). Is there a relationship?
</li>
<li>
Redraw the scatter plot but this time use different symbols or colors for the different treatment groups. Add a legend to identify the symbols. Describe the pattern of differences between treatments.
</li>
<li>
Add scatterplot smoothers or linear regressions to the previous figure, one for each group. Do the differences in longevity among the treatments stand out when variation in body size is incorporated?
</li>
</ol>
</div>
<div id="answers-3" class="section level3">
<h3>Answers</h3>
<p>All lines below beginning with double hashes are R output</p>
<pre class="r"><code># Read and inspect data
x &lt;- read.csv(url(&quot;https://www.zoology.ubc.ca/~bio501/R/data/fruitflies.csv&quot;),
              stringsAsFactors = FALSE)

head(x)</code></pre>
<pre><code>##   Npartners          treatment longevity.days thorax.mm
## 1         8 8 pregnant females             35      0.64
## 2         8 8 pregnant females             37      0.68
## 3         8 8 pregnant females             49      0.68
## 4         8 8 pregnant females             46      0.72
## 5         8 8 pregnant females             63      0.72
## 6         8 8 pregnant females             39      0.76</code></pre>
<pre class="r"><code># Strip chart
stripchart(longevity.days ~ treatment, data=x, vertical=TRUE, method=&quot;jitter&quot;, 
                pch=16, col = &quot;firebrick&quot;, cex.axis=0.7, ylab=&quot;Longevity (days)&quot;)</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-9-1.png" width="528" /></p>
<pre class="r"><code># Strip chart using ggplot
ggplot(x, aes(x=treatment, y=longevity.days)) +
  geom_jitter(color = &quot;firebrick&quot;, size = 3, width = 0.15) +
  labs(x = &quot;Treatment&quot;, y = &quot;Longevity (days)&quot;) + 
  theme_classic()</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-9-2.png" width="528" /></p>
<pre class="r"><code># Box plot
boxplot(longevity.days ~ treatment, data=x, cex.axis=.7, ylab=&quot;Longevity (days)&quot;, 
      boxwex=0.5, col = &quot;goldenrod1&quot;)</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-9-3.png" width="528" /></p>
<pre class="r"><code># Box plot using ggplot
ggplot(x, aes(x=treatment, y=longevity.days)) +
  geom_boxplot(fill = &quot;goldenrod1&quot;, width = 0.5) +
  labs(x = &quot;Treatment&quot;, y = &quot;Longevity (days)&quot;) + 
  theme_classic()</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-9-4.png" width="528" /></p>
<pre class="r"><code># Scatter plot
plot(longevity.days ~ thorax.mm, data = x, pch = 16, col = &quot;firebrick&quot;, las = 1,
     xlab = &quot;Thorax length (mm)&quot;, ylab = &quot;Longevity (days)&quot;)</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-9-5.png" width="528" /></p>
<pre class="r"><code># Scatter plot with ggplot
ggplot(x, aes(x = thorax.mm, y = longevity.days)) + 
    geom_point(size = 3, col = &quot;firebrick&quot;) + 
    labs(x = &quot;Thorax length (mm)&quot;, y = &quot;Longevity (days)&quot;) + 
    theme_classic()</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-9-6.png" width="528" /></p>
<pre class="r"><code># Scatter plot with separate colors for each group (not run)
plot(longevity.days ~ thorax.mm, data=x, pch=as.numeric(factor(treatment)), 
        col=as.numeric(factor(treatment)), las = 1, 
        xlab = &quot;Thorax length (mm)&quot;, ylab = &quot;Longevity (days)&quot;)
legend( locator(1), legend = as.character(levels(factor(x$treatment))),
        pch=1:length(levels(factor(x$treatment))), 
        col=1:length(levels(factor(x$treatment))) )</code></pre>
<pre class="r"><code># Scatter plot with separate colors for each group using ggplot
ggplot(x, aes(x = thorax.mm, y = longevity.days, colour = treatment, 
            shape = treatment)) + 
    geom_point(size = 2) + 
    labs(x = &quot;Thorax length (mm)&quot;, y = &quot;Longevity (days)&quot;) + 
    theme_classic()</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-11-1.png" width="528" /></p>
<pre class="r"><code># Add lines; shown for ggplot method only
ggplot(x, aes(x=thorax.mm, y=longevity.days, colour = treatment, 
            shape = treatment)) + 
    geom_point(size = 2) +
    geom_smooth(method = lm, size = 1, se = FALSE) +
    labs(x = &quot;Thorax length (mm)&quot;, y = &quot;Longevity (days)&quot;) + 
    theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="graphics_files/figure-html/unnamed-chunk-11-2.png" width="528" /></p>
</div>
</div>

&nbsp;
<hr />
<p style="text-align: left;">
&copy; 2009-2020 Dolph Schluter
</p>
&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
